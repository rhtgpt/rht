<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: TO_ServiceArea_Validation_v3 Pages: 1 -->
<svg width="2400pt" height="836pt"
 viewBox="0.00 0.00 576.00 200.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.27 1.27) rotate(0) translate(4 656)">
<title>TO_ServiceArea_Validation_v3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-656 1890,-656 1890,4 -4,4"/>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<polygon fill="none" stroke="black" points="960.5,-652 795.5,-652 795.5,-599 960.5,-599 960.5,-652"/>
<text text-anchor="middle" x="878" y="-636.8" font-family="Arial" font-size="14.00">Start</text>
<text text-anchor="middle" x="878" y="-621.8" font-family="Arial" font-size="14.00">Subscribe to Kafka topic</text>
<text text-anchor="middle" x="878" y="-606.8" font-family="Arial" font-size="14.00">(service_area_snapshot)</text>
</g>
<!-- B -->
<g id="node2" class="node">
<title>B</title>
<polygon fill="none" stroke="black" points="1031,-563 725,-563 725,-527 1031,-527 1031,-563"/>
<text text-anchor="middle" x="878" y="-541.3" font-family="Arial" font-size="14.00">Receive &amp; validate Service Area Kafka message</text>
</g>
<!-- A&#45;&gt;B -->
<g id="edge1" class="edge">
<title>A&#45;&gt;B</title>
<path fill="none" stroke="black" d="M878,-598.8C878,-590.71 878,-581.76 878,-573.55"/>
<polygon fill="black" stroke="black" points="881.5,-573.33 878,-563.33 874.5,-573.33 881.5,-573.33"/>
</g>
<!-- C -->
<g id="node3" class="node">
<title>C</title>
<polygon fill="none" stroke="black" points="1038,-491 718,-491 718,-438 1038,-438 1038,-491"/>
<text text-anchor="middle" x="878" y="-475.8" font-family="Arial" font-size="14.00">Query TOM DB for Transfer Orders</text>
<text text-anchor="middle" x="878" y="-460.8" font-family="Arial" font-size="14.00">(status=OPEN, lineStatus=CREATED,</text>
<text text-anchor="middle" x="878" y="-445.8" font-family="Arial" font-size="14.00">type!=&#39;CT&#39;, destination=event.destination_location)</text>
</g>
<!-- B&#45;&gt;C -->
<g id="edge2" class="edge">
<title>B&#45;&gt;C</title>
<path fill="none" stroke="black" d="M878,-526.97C878,-519.45 878,-510.31 878,-501.4"/>
<polygon fill="black" stroke="black" points="881.5,-501.16 878,-491.16 874.5,-501.16 881.5,-501.16"/>
</g>
<!-- D -->
<g id="node4" class="node">
<title>D</title>
<polygon fill="none" stroke="black" points="1003,-402 753,-402 753,-364 1003,-364 1003,-402"/>
<text text-anchor="middle" x="878" y="-386.8" font-family="Arial" font-size="14.00">Compare TO.origin with</text>
<text text-anchor="middle" x="878" y="-371.8" font-family="Arial" font-size="14.00">Kafka message.servicingNodes.origins</text>
</g>
<!-- C&#45;&gt;D -->
<g id="edge3" class="edge">
<title>C&#45;&gt;D</title>
<path fill="none" stroke="black" d="M878,-437.91C878,-429.74 878,-420.65 878,-412.3"/>
<polygon fill="black" stroke="black" points="881.5,-412.24 878,-402.24 874.5,-412.24 881.5,-412.24"/>
</g>
<!-- N1 -->
<g id="node5" class="node">
<title>N1</title>
<polygon fill="none" stroke="black" points="224,-328 0,-290 224,-252 448,-290 224,-328"/>
<text text-anchor="middle" x="224" y="-293.8" font-family="Arial" font-size="14.00">No itemOverrides[] AND</text>
<text text-anchor="middle" x="224" y="-278.8" font-family="Arial" font-size="14.00">TO.origin NOT in servicingNodes?</text>
</g>
<!-- D&#45;&gt;N1 -->
<g id="edge4" class="edge">
<title>D&#45;&gt;N1</title>
<path fill="none" stroke="black" d="M752.6,-366.91C668.82,-356.59 556.2,-342.24 457,-328 420.5,-322.76 380.85,-316.63 344.79,-310.88"/>
<polygon fill="black" stroke="black" points="345.14,-307.4 334.71,-309.27 344.04,-314.31 345.14,-307.4"/>
</g>
<!-- N2 -->
<g id="node7" class="node">
<title>N2</title>
<polygon fill="none" stroke="black" points="660,-328 466,-290 660,-252 854,-290 660,-328"/>
<text text-anchor="middle" x="660" y="-293.8" font-family="Arial" font-size="14.00">No itemOverrides[] AND</text>
<text text-anchor="middle" x="660" y="-278.8" font-family="Arial" font-size="14.00">TO.origin IN servicingNodes?</text>
</g>
<!-- D&#45;&gt;N2 -->
<g id="edge6" class="edge">
<title>D&#45;&gt;N2</title>
<path fill="none" stroke="black" d="M834.67,-363.91C804.82,-351.45 764.49,-334.62 730.11,-320.27"/>
<polygon fill="black" stroke="black" points="731.16,-316.91 720.58,-316.29 728.46,-323.37 731.16,-316.91"/>
</g>
<!-- O1 -->
<g id="node9" class="node">
<title>O1</title>
<polygon fill="none" stroke="black" points="1096,-328 872,-290 1096,-252 1320,-290 1096,-328"/>
<text text-anchor="middle" x="1096" y="-293.8" font-family="Arial" font-size="14.00">itemOverrides[] present AND</text>
<text text-anchor="middle" x="1096" y="-278.8" font-family="Arial" font-size="14.00">TO.origin NOT in servicingNodes?</text>
</g>
<!-- D&#45;&gt;O1 -->
<g id="edge8" class="edge">
<title>D&#45;&gt;O1</title>
<path fill="none" stroke="black" d="M921.33,-363.91C950.5,-351.74 989.67,-335.38 1023.53,-321.25"/>
<polygon fill="black" stroke="black" points="1025.04,-324.41 1032.92,-317.33 1022.35,-317.95 1025.04,-324.41"/>
</g>
<!-- O2 -->
<g id="node11" class="node">
<title>O2</title>
<polygon fill="none" stroke="black" points="1532,-328 1338,-290 1532,-252 1726,-290 1532,-328"/>
<text text-anchor="middle" x="1532" y="-293.8" font-family="Arial" font-size="14.00">itemOverrides[] present AND</text>
<text text-anchor="middle" x="1532" y="-278.8" font-family="Arial" font-size="14.00">TO.origin IN servicingNodes?</text>
</g>
<!-- D&#45;&gt;O2 -->
<g id="edge10" class="edge">
<title>D&#45;&gt;O2</title>
<path fill="none" stroke="black" d="M1003.19,-369.09C1093.85,-359.23 1219.25,-344.56 1329,-328 1360.96,-323.18 1395.62,-317.16 1427.09,-311.38"/>
<polygon fill="black" stroke="black" points="1427.99,-314.78 1437.19,-309.52 1426.72,-307.89 1427.99,-314.78"/>
</g>
<!-- N1A -->
<g id="node6" class="node">
<title>N1A</title>
<polygon fill="none" stroke="black" points="353,-216 95,-216 95,-163 353,-163 353,-216"/>
<text text-anchor="middle" x="224" y="-200.8" font-family="Arial" font-size="14.00">Cancel entire TO</text>
<text text-anchor="middle" x="224" y="-185.8" font-family="Arial" font-size="14.00">Reason: ORIGIN_NOT_SERVICEABLE</text>
<text text-anchor="middle" x="224" y="-170.8" font-family="Arial" font-size="14.00">Publish TO_CANCELLED</text>
</g>
<!-- N1&#45;&gt;N1A -->
<g id="edge5" class="edge">
<title>N1&#45;&gt;N1A</title>
<path fill="none" stroke="black" d="M224,-251.76C224,-243.41 224,-234.57 224,-226.28"/>
<polygon fill="black" stroke="black" points="227.5,-226.15 224,-216.15 220.5,-226.15 227.5,-226.15"/>
</g>
<!-- N2A -->
<g id="node8" class="node">
<title>N2A</title>
<polygon fill="none" stroke="black" points="723.5,-208.5 596.5,-208.5 596.5,-170.5 723.5,-170.5 723.5,-208.5"/>
<text text-anchor="middle" x="660" y="-193.3" font-family="Arial" font-size="14.00">TO valid</text>
<text text-anchor="middle" x="660" y="-178.3" font-family="Arial" font-size="14.00">No action required</text>
</g>
<!-- N2&#45;&gt;N2A -->
<g id="edge7" class="edge">
<title>N2&#45;&gt;N2A</title>
<path fill="none" stroke="black" d="M660,-251.76C660,-240.84 660,-229.09 660,-218.82"/>
<polygon fill="black" stroke="black" points="663.5,-218.76 660,-208.76 656.5,-218.76 663.5,-218.76"/>
</g>
<!-- O1A -->
<g id="node10" class="node">
<title>O1A</title>
<polygon fill="none" stroke="black" points="1182.5,-208.5 1009.5,-208.5 1009.5,-170.5 1182.5,-170.5 1182.5,-208.5"/>
<text text-anchor="middle" x="1096" y="-193.3" font-family="Arial" font-size="14.00">Cancel entire TO</text>
<text text-anchor="middle" x="1096" y="-178.3" font-family="Arial" font-size="14.00">Publish TO_CANCELLED</text>
</g>
<!-- O1&#45;&gt;O1A -->
<g id="edge9" class="edge">
<title>O1&#45;&gt;O1A</title>
<path fill="none" stroke="black" d="M1096,-251.76C1096,-240.84 1096,-229.09 1096,-218.82"/>
<polygon fill="black" stroke="black" points="1099.5,-218.76 1096,-208.76 1092.5,-218.76 1099.5,-218.76"/>
</g>
<!-- I1 -->
<g id="node12" class="node">
<title>I1</title>
<polygon fill="none" stroke="black" points="1532,-207.5 1305.77,-189.5 1532,-171.5 1758.23,-189.5 1532,-207.5"/>
<text text-anchor="middle" x="1532" y="-185.8" font-family="Arial" font-size="14.00">Any invalid items per itemOverrides[]?</text>
</g>
<!-- O2&#45;&gt;I1 -->
<g id="edge11" class="edge">
<title>O2&#45;&gt;I1</title>
<path fill="none" stroke="black" d="M1532,-251.76C1532,-240.52 1532,-228.39 1532,-217.91"/>
<polygon fill="black" stroke="black" points="1535.5,-217.7 1532,-207.7 1528.5,-217.7 1535.5,-217.7"/>
</g>
<!-- I1A -->
<g id="node13" class="node">
<title>I1A</title>
<polygon fill="none" stroke="black" points="1488,-127 1350,-127 1350,-89 1488,-89 1488,-127"/>
<text text-anchor="middle" x="1419" y="-111.8" font-family="Arial" font-size="14.00">No → All items valid</text>
<text text-anchor="middle" x="1419" y="-96.8" font-family="Arial" font-size="14.00">No action required</text>
</g>
<!-- I1&#45;&gt;I1A -->
<g id="edge12" class="edge">
<title>I1&#45;&gt;I1A</title>
<path fill="none" stroke="black" d="M1510.21,-173.17C1493.97,-161.75 1471.49,-145.93 1452.9,-132.85"/>
<polygon fill="black" stroke="black" points="1454.87,-129.96 1444.68,-127.06 1450.84,-135.68 1454.87,-129.96"/>
</g>
<!-- I2 -->
<g id="node14" class="node">
<title>I2</title>
<polygon fill="none" stroke="black" points="1645,-126 1506.41,-108 1645,-90 1783.59,-108 1645,-126"/>
<text text-anchor="middle" x="1645" y="-104.3" font-family="Arial" font-size="14.00">Are ALL items invalid?</text>
</g>
<!-- I1&#45;&gt;I2 -->
<g id="edge13" class="edge">
<title>I1&#45;&gt;I2</title>
<path fill="none" stroke="black" d="M1553.79,-173.17C1571.55,-160.67 1596.79,-142.91 1616.22,-129.25"/>
<polygon fill="black" stroke="black" points="1618.26,-132.09 1624.42,-123.48 1614.23,-126.37 1618.26,-132.09"/>
</g>
<!-- I2A -->
<g id="node15" class="node">
<title>I2A</title>
<polygon fill="none" stroke="black" points="1615.5,-45.5 1442.5,-45.5 1442.5,-7.5 1615.5,-7.5 1615.5,-45.5"/>
<text text-anchor="middle" x="1529" y="-30.3" font-family="Arial" font-size="14.00">Yes → Cancel entire TO</text>
<text text-anchor="middle" x="1529" y="-15.3" font-family="Arial" font-size="14.00">Publish TO_CANCELLED</text>
</g>
<!-- I2&#45;&gt;I2A -->
<g id="edge14" class="edge">
<title>I2&#45;&gt;I2A</title>
<path fill="none" stroke="black" d="M1623.99,-92.6C1607.27,-81.14 1583.51,-64.86 1563.94,-51.44"/>
<polygon fill="black" stroke="black" points="1565.79,-48.47 1555.56,-45.7 1561.83,-54.24 1565.79,-48.47"/>
</g>
<!-- I2B -->
<g id="node16" class="node">
<title>I2B</title>
<polygon fill="none" stroke="black" points="1886,-53 1634,-53 1634,0 1886,0 1886,-53"/>
<text text-anchor="middle" x="1760" y="-37.8" font-family="Arial" font-size="14.00">No → Cancel only impacted items</text>
<text text-anchor="middle" x="1760" y="-22.8" font-family="Arial" font-size="14.00">Update TO &amp; mark items CANCELLED</text>
<text text-anchor="middle" x="1760" y="-7.8" font-family="Arial" font-size="14.00">Publish TO_UPDATE</text>
</g>
<!-- I2&#45;&gt;I2B -->
<g id="edge15" class="edge">
<title>I2&#45;&gt;I2B</title>
<path fill="none" stroke="black" d="M1665.83,-92.6C1679.38,-83.23 1697.61,-70.63 1714.42,-59.01"/>
<polygon fill="black" stroke="black" points="1716.81,-61.61 1723.05,-53.04 1712.83,-55.85 1716.81,-61.61"/>
</g>
</g>
</svg>
